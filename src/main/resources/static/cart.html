<!DOCTYPE html>
<html lang="zh-TW">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>線上購物系統</title>

	<script src="/javascripts/common/imports.js"></script>

	<link rel="stylesheet" href="/styles/cart.css">
</head>

<body>
	<div id="app">
		<store-header></store-header>

		<div class="container py-4">

			<b-card header="購物車內容" class="mb-4">
				<b-list-group flush>
					<b-list-group-item v-for="item in cart" :key="item.productId">
						<b-row class="align-items-center">
							<b-col md="5" cols="12">
								<h5 class="mb-1">{{ item.name }}</h5>
								<small class="text-muted">單價: ${{ item.price }}</small>
							</b-col>

							<b-col md="3" cols="5">
								<b-form-input type="number" v-model.number="item.quantity" min="1"
									@change="updateItemQuantity(item)" size="sm">
								</b-form-input>
							</b-col>

							<b-col md="3" cols="5" class="text-right">
								<span class="font-weight-bold">小計: ${{ item.price * item.quantity }}</span>
							</b-col>

							<b-col md="1" cols="2" class="text-right">
								<b-button variant="outline-danger" size="sm" @click="removeItem(item.productId)">
									<i class="fa fa-trash"></i>
								</b-button>
							</b-col>
						</b-row>
					</b-list-group-item>
				</b-list-group>

				<div class="text-right mt-3">
					<span class="font-weight-bold h4 text-danger">總金額: ${{ totalAmount }}</span>
				</div>
			</b-card>

			<b-card header="訂購資訊">
				<b-form @submit.prevent="submitOrder">
					<b-form-group label="訂購人姓名：" label-for="cust-name">
						<b-form-input id="cust-name" v-model.trim="order.custName" required></b-form-input>
					</b-form-group>
					<b-row>
						<b-col md="6">
							<b-form-group label="電話：" label-for="cust-number">
								<b-form-input id="cust-number" v-model.trim="order.custNumber" required></b-form-input>
							</b-form-group>
						</b-col>
						<b-col md="6">
							<b-form-group label="7-11超商取貨店名：" label-for="cust-ship">
								<b-form-input id="cust-ship" v-model.trim="order.custShip" required></b-form-input>
							</b-form-group>
						</b-col>
					</b-row>
					<b-form-group label="備註：" label-for="comment">
						<b-form-textarea id="comment" v-model="order.comment" rows="3"></b-form-textarea>
					</b-form-group>
					<b-button type="submit" variant="success" size="lg" block>送出訂單</b-button>
				</b-form>
			</b-card>
		</div>

	</div>

	<script src="/javascripts/common/util.js"></script>
	<script src="/javascripts/store/cart.js"></script>

</body>

</html>